# Personal Info Masking Chrome Extension

個人情報をリアルタイムでマスキングするChrome拡張機能です。Webページ上の個人情報を自動検出し、視覚的にマスクして安全な閲覧を実現します。

## 🎯 主な機能

- **リアルタイム検出**: ページ上の個人情報を自動検出
- **多様なマスキング効果**: モザイク、ぼかし、黒塗り、ピクセル化
- **日本語対応**: 日本の個人情報パターンに最適化
- **カスタマイズ可能**: 検出感度とマスキングタイプの調整
- **動的対応**: ページの動的変更にもリアルタイムで対応

## 🔍 検出対象

| 情報種別 | 例 | デフォルトマスキング |
|---------|----|--------------------|
| メールアドレス | test@example.com | ぼかし |
| 電話番号 | 090-1234-5678 | モザイク |
| クレジットカード | 4111-1111-1111-1111 | ピクセル化 |
| 郵便番号 | 100-0001 | 黒塗り |
| 日本語氏名 | 田中太郎 | ぼかし |
| 住所 | 東京都渋谷区 | 黒塗り |
| マイナンバー | 1234-5678-9012 | 黒塗り |
| 生年月日 | 1990年5月15日 | ぼかし |

## 🚀 インストール方法

### 開発版のインストール

1. **リポジトリのクローン**
   ```bash
   git clone https://github.com/your-username/personal_info_masking_men.git
   cd personal_info_masking_men
   ```

2. **依存関係のインストール**
   ```bash
   npm install
   ```

3. **ビルド実行**
   ```bash
   npm run build
   ```

4. **Chrome拡張機能として読み込み**
   - Chromeで `chrome://extensions/` を開く
   - 「デベロッパーモード」を有効化
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - `dist` フォルダを選択

## 🛠️ 開発環境

### 必要要件

- Node.js 20.15.0+
- npm 9.0.0+
- Chrome 88+

### 技術スタック

- **言語**: TypeScript 5.4.2
- **ビルドツール**: Webpack 5.91.0
- **拡張機能**: Manifest V3
- **画像処理**: Canvas API
- **DOM監視**: MutationObserver

### 開発コマンド

```bash
# 開発用ビルド
npm run build:dev

# 本番用ビルド
npm run build

# 監視モード（開発中）
npm run watch

# 型チェック
npm run type-check

# リント
npm run lint

# ビルド成果物の削除
npm run clean
```

## 📖 使用方法

### 基本操作

1. **拡張機能アイコン**をクリック
2. **メインスイッチをON**にしてマスキングを有効化
3. **個人情報が含まれるページ**を閲覧
4. **自動的にマスキング**が適用されます

### 設定カスタマイズ

ポップアップUIから以下の設定が可能：

#### マスキングタイプ設定
- **メールアドレス**: ぼかし/モザイク/黒塗り/ピクセル化
- **電話番号**: ぼかし/モザイク/黒塗り/ピクセル化  
- **クレジットカード**: ぼかし/モザイク/黒塗り/ピクセル化

#### 動作設定
- **リアルタイム処理**: 動的なページ変更への対応（推奨：ON）
- **検出感度**: 
  - **低**: 確実な個人情報のみ検出
  - **中**: バランス型（推奨）
  - **高**: 疑わしいものも含めて検出

## 🏗️ プロジェクト構造

```
src/
├── background/          # バックグラウンドスクリプト
│   └── background.ts    # 拡張機能のライフサイクル管理
├── content/            # コンテンツスクリプト  
│   └── content.ts      # DOM操作・マスキング実行
├── popup/              # ポップアップUI
│   ├── popup.html      # UI構造
│   └── popup.ts        # UI制御ロジック
├── utils/              # ユーティリティ
│   ├── pii-detector.ts # PII検出エンジン
│   ├── pii-patterns.ts # 検出パターン定義
│   └── masking-engine.ts # マスキングエンジン
├── types/              # TypeScript型定義
│   └── index.ts        
├── icons/              # アイコン画像
└── manifest.json       # 拡張機能設定
```

### 主要コンポーネント

#### PII検出エンジン (`pii-detector.ts`)
- コンテキスト解析による高精度検出
- 誤検出フィルタリング機能
- 日本語特有パターンの対応

#### マスキングエンジン (`masking-engine.ts`)  
- Canvas APIベースの視覚効果
- 複数のマスキングアルゴリズム
- パフォーマンス最適化

#### パターン定義 (`pii-patterns.ts`)
- 日本の個人情報に特化した正規表現
- カスタマイズ可能な検出パターン
- 感度レベル対応

## 🔒 プライバシー・セキュリティ

### プライバシー保護
- ✅ **完全ローカル処理** - 外部サーバーへのデータ送信なし
- ✅ **一時的マスキング** - 元データは改変せず表示のみ変更
- ✅ **設定の暗号化** - Chrome内蔵ストレージで安全に保存

### セキュリティ考慮事項
- Content Security Policy（CSP）準拠
- 最小権限の原則に基づくpermissions設定
- XSS攻撃対策の実装

## 🧪 テスト

### 基本動作テスト

テスト用HTMLファイルで動作確認：

```bash
# ブラウザでローカルファイルを開く
file:///path/to/chrome-extension-test.html
```

### デバッグ方法

開発者ツール（F12）でコンソールログを確認：

```javascript
// 期待されるログ出力
[PII Masking] Content script starting...
[PII Masking] Settings loaded: {...}
[PII Detector] Testing pattern email: [a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}
[PII Detector] Pattern email found 3 raw matches
[PII Detector] Raw match 0 for email: "test@gmail.com"
```

## 🤝 貢献・開発参加

### 課題・バグ報告

GitHub Issuesでバグ報告や機能要望をお寄せください。

### 開発への参加

1. フォークする
2. 機能ブランチを作成 (`git checkout -b feature/AmazingFeature`)
3. 変更をコミット (`git commit -m 'Add some AmazingFeature'`)
4. ブランチにプッシュ (`git push origin feature/AmazingFeature`)
5. プルリクエストを作成

## 📄 ライセンス

MIT License - 詳細は [LICENSE](LICENSE) ファイルを参照

## 🔄 更新履歴

### v1.0.0
- 基本的なPII検出・マスキング機能
- 日本語対応パターン
- リアルタイム処理
- カスタマイズ可能なUI

## 🆘 トラブルシューティング

### よくある問題

**Q: マスキングが効かない**
- 拡張機能が有効になっているか確認
- ページを再読み込み（F5）
- 検出感度を「高」に変更

**Q: 動作が重い**
- リアルタイム処理をOFFに変更
- 検出感度を「低」に設定

**Q: 意図しないテキストがマスクされる**
- 検出感度を「低」に変更
- 特定のパターンを無効化

### ログ確認方法

1. 開発者ツール（F12）を開く
2. Consoleタブで `[PII Masking]` のメッセージを確認
3. エラーメッセージがあれば報告

## 📞 サポート

技術的な質問やサポートが必要な場合：

- GitHub Issues での質問
- 開発者ツールのログを添付
- 問題が発生するWebページのURL（可能であれば）

---

**注意**: この拡張機能は個人情報保護のためのツールです。100%の検出精度を保証するものではありません。重要な情報を扱う際は、追加的なセキュリティ対策も併用してください。